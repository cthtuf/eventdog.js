/**
 * EventDog v1.1
 * (c) 2015 Cubeline agency. http://www.cubeline.ru/
 * author: Philipp Sirotkin. labstersrak@gmail.com
 * License: MIT
 */
eventdog=function(){var e=$.fn.on,t=EventTarget.prototype.addEventListener;$.fn.on=function(){return e.apply(this,arguments).trigger("addEvent")},EventTarget.prototype.addEventListener=function(e,n,a){this.origEvent=t,this.origEvent(e,n,a),$(this).trigger("addEvent")},String.prototype.unicodeToChar=function(){return this.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,function(e){return String.fromCharCode(parseInt(e.replace(/\\u/g,""),16))})},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.clearText=function(){return this.unicodeToChar().toLowerCase().replace(/[^a-zа-я0-9-!?ё]/g,"")};var n=function(){console.error("Нужно указать функцию через параметр callback для её последующего вызова вызова")};return $.fn.bindFirst=function(e,t,n){var a=e.indexOf("."),i=a>0?e.substring(a):"";return e=a>0?e.substring(0,a):e,n=void 0==n?t:n,t="function"==typeof t?{}:t,this.each(function(){var a=$(this),r=this["on"+e];r&&(a.bind(e,function(e){return r(e.originalEvent)}),this["on"+e]=null),a.bind(e+i,t,n);var c=a.data("events")||$._data(a[0],"events"),o=c[e],f=o.pop();o.unshift(f)})},$.fn.bindLast=function(e,t){return this.each(function(){var n=1e6,a=e.split("."),i=a[0];$(this).on(e,t);var r=this;$(this).on("addEvent",function(e){var a=$._data(r,"events"),c=!1,o={};if($.each(a[i],function(e,n){n.handler===t&&(c=e),o[e]=1}),c!==!1){for(;1==o[n];)n++;var f=a[i].length-1,u=a[i][c];a[i].splice(c,1),a[i].splice(f,0,u),$(r).data("events",a)}})})},{ajax:function(e){if(e="undefined"!=typeof e?e:{},e.callback="undefined"!=typeof e.callback?e.callback:-1,"undefined"!=typeof e.events){e.events=e.events.toLowerCase().split(" ");for(var t=0;t<e.events.length;++t)e.events[t]="ajax"+e.events[t].capitalize();e.events=e.events.toString().replace(","," ")}else e.events="ajaxSend";"undefined"!=typeof e.element&&"undefined"==typeof e.url&&(e.element=$(e.element),e.element.attr("action").length&&(e.url=e.element.attr("action"))),"undefined"!=typeof e.url?$(document).on(e.events,function(t,a,i,r){if(-1!==i.url.indexOf(e.url))if("undefined"!=typeof e.substring){if("undefined"==typeof r)return;if(-1!==r.clearText().indexOf(e.substring.clearText()))try{e.callback()}catch(c){n()}}else try{e.callback()}catch(c){n()}}):$(document).on(e.events,function(t,a,i,r){if("undefined"!=typeof e.substring){if("undefined"==typeof r)return;if(-1!==r.clearText().indexOf(e.substring.clearText()))try{e.callback()}catch(c){n()}}else try{e.callback()}catch(c){n()}})},dom:function(e){e="undefined"!=typeof e?e:{},"undefined"==typeof e.element&&(e.element=document);var t=$(e.element);"undefined"==typeof e.substring?t.on("DOMSubtreeModified keyup change",function(){try{e.callback()}catch(t){n()}}):t.on("DOMSubtreeModified change",function(){var a=null;if(a="INPUT"==t[0].tagName||"TEXTAREA"==t[0].tagName||"SELECT"==t[0].tagName?t.val():t.text(),-1!==a.clearText().indexOf(e.substring.clearText()))try{e.callback()}catch(i){n()}})},click:function(e){try{var t=$(e.element);t.bindFirst("click",e.callback)}catch(a){n()}},submit:function(e){try{var t=$(e.element);t.bindFirst("submit",e.callback)}catch(a){n()}},change:function(e){try{var t=$(e.element);t.bindLast("change",e.callback)}catch(a){n()}}}}();