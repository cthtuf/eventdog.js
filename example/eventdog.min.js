/**
 * EventDog v1.1
 * (c) 2015 Cubeline agency. http://www.cubeline.ru/
 * author: Philipp Sirotkin. sirotkin@cubeline.ru
 * License: MIT
 */
var origOn=$.fn.on,origEvent=EventTarget.prototype.addEventListener;$.fn.on=function(){return origOn.apply(this,arguments).trigger("addEvent")},EventTarget.prototype.addEventListener=function(a,b,c){this.origEvent=origEvent,this.origEvent(a,b,c),$(this).trigger("addEvent")},eventdog=function(){String.prototype.unicodeToChar=function(){return this.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,function(a){return String.fromCharCode(parseInt(a.replace(/\\u/g,""),16))})},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.clearText=function(){return this.unicodeToChar().toLowerCase().replace(/[^a-z\u0430-\u044f0-9-!?\u0451]/g,"")};var a=function(){console.error("\u041d\u0443\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0447\u0435\u0440\u0435\u0437 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 callback \u0434\u043b\u044f \u0435\u0451 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u0432\u044b\u0437\u043e\u0432\u0430 \u0432\u044b\u0437\u043e\u0432\u0430")};return $.fn.bindFirst=function(a,b,c){var d=a.indexOf("."),e=d>0?a.substring(d):"";return a=d>0?a.substring(0,d):a,c=void 0==c?b:c,b="function"==typeof b?{}:b,this.each(function(){var d=$(this),f=this["on"+a];f&&(d.bind(a,function(a){return f(a.originalEvent)}),this["on"+a]=null),d.bind(a+e,b,c);var g=d.data("events")||$._data(d[0],"events"),h=g[a],i=h.pop();h.unshift(i)})},$.fn.bindLast=function(a,b){return this.each(function(){var c=1e6,d=a.split("."),e=d[0];$(this).on(a,b);var f=this;$(this).on("addEvent",function(){var d=$._data(f,"events"),g=!1,h={};if($.each(d[e],function(a,c){c.handler===b&&(g=a),h[a]=1}),console.log(h),g!==!1){for(;1==h[c];)c++;console.log(d[e][g]),d[e][c]=d[e][g],delete d[e][g],console.log(d[e]),$(f).data("events",d)}})})},{ajax:function(b){if(b="undefined"!==typeof b?b:{},b.callback="undefined"!==typeof b.callback?b.callback:-1,"undefined"!==typeof b.events){b.events=b.events.toLowerCase().split(" ");for(var c=0;c<b.events.length;++c)b.events[c]="ajax"+b.events[c].capitalize();b.events=b.events.toString().replace(","," ")}else b.events="ajaxSend";"undefined"!==typeof b.element&&"undefined"==typeof b.url&&(b.element=$(b.element),b.element.attr("action").length&&(b.url=b.element.attr("action"))),"undefined"!==typeof b.url?$(document).on(b.events,function(c,d,e,f){if(-1!==e.url.indexOf(b.url))if("undefined"!==typeof b.substring){if("undefined"==typeof f)return;if(-1!==f.clearText().indexOf(b.substring.clearText()))try{b.callback()}catch(g){a()}}else try{b.callback()}catch(g){a()}}):$(document).on(b.events,function(c,d,e,f){if("undefined"!==typeof b.substring){if("undefined"==typeof f)return;if(-1!==f.clearText().indexOf(b.substring.clearText()))try{b.callback()}catch(g){a()}}else try{b.callback()}catch(g){a()}})},dom:function(b){b="undefined"!==typeof b?b:{},"undefined"==typeof b.element&&(b.element=document);var c=$(b.element);"undefined"==typeof b.substring?c.on("DOMSubtreeModified keyup change",function(){try{b.callback()}catch(c){a()}}):c.on("DOMSubtreeModified change",function(){var d=null;if(d="INPUT"==c[0].tagName||"TEXTAREA"==c[0].tagName?c.val():c.text(),-1!==d.clearText().indexOf(b.substring.clearText()))try{b.callback()}catch(e){a()}})},click:function(a){var b=$(a.element);b.bindFirst("click",a.callback)},submit:function(a){var b=$(a.element);b.bindFirst("submit",a.callback)},change:function(a){var b=$(a.element);b.bindLast("change",a.callback)}}}();